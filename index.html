<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pioneros de Coronel Pringles 1870-1903</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .text-brown-custom {
            color: #4b3829;
        }
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.9);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            margin: auto;
            display: block;
            width: 90%;
            max-width: 700px;
        }
        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
        }
        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
        #message-modal .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            max-width: 400px;
            text-align: center;
        }
        #message-modal h3 {
            font-size: 1.5rem;
            font-weight: bold;
        }
        /* Estilos específicos para el dropdown */
        .dropdown {
            position: relative;
            display: inline-block;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 200px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            right: 0; /* Alinea el dropdown a la derecha */
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            text-align: left;
        }
        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }
        /* Clase para mostrar el dropdown al hacer click */
        .dropdown-content.show-dropdown {
            display: block;
        }
        /* Estilos para los botones del carrusel en el modal */
        .prev, .next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            padding: 16px;
            margin-top: -50px;
            color: white;
            font-weight: bold;
            font-size: 20px;
            transition: 0.6s ease;
            border-radius: 0 3px 3px 0;
            user-select: none;
            -webkit-user-select: none;
            background-color: rgba(0,0,0,0.8);
        }
        .next {
            right: 0;
            border-radius: 3px 0 0 3px;
        }
        .prev {
            left: 0;
            border-radius: 0 3px 3px 0;
        }
        .prev:hover, .next:hover {
            background-color: rgba(0,0,0,1);
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Encabezado con fondo naranja -->
     <header class="bg-[#e45d17] text-white p-4 md:p-8 shadow-lg">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center text-center md:text-left">
            <h1 class="text-3xl md:text-5xl font-bold tracking-tight mb-4 md:mb-0">PIONEROS DE CORONEL PRINGLES I 1870-1903</h1>
           
            <!-- Menú desplegable en la esquina superior derecha -->
            <div class="dropdown md:ml-auto">
                <button class="bg-white text-gray-800 font-bold py-2 px-4 rounded-lg shadow-md hover:bg-gray-200 transition-colors duration-300 flex items-center" aria-haspopup="true" aria-expanded="false" id="dropdown-toggle-btn">
                    Menú
                    <svg class="ml-2 -mr-1 w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                </button>
                <div class="dropdown-content" aria-labelledby="dropdown-toggle-btn">
                    <a href="#" id="dropdown-gallery-btn">Galería</a>
                    <a href="https://drive.google.com/file/d/1gjxOYU4XM3SLWIbt_9uTZzrzjc8jyppS/view?usp=drivesdk" target="_blank">Descarga Listado A-B Pioneros I</a>
                    <a href="https://www.facebook.com/people/Investigaci%C3%B3n-Hist%C3%B3rica-Coronel-Pringles/100068762413207/?name=xhp_nt__fb__action__open_user" target="_blank">Página de Facebook</a>
                    <a href="https://articulo.mercadolibre.com.ar/MLA-1515266761-pioneros-de-coronel-pringles-1870-1903-i-_JM#polycard_client=search-nordic&position=36&search_layout=stack&type=item&tracking_id=2893e5d4-75db-49c8-8ecf-e9f2ec34ee24&wid=MLA1515266761&sid=search" target="_blank">Compra el libro</a>
                    <a href="https://www.paypal.com/ncp/payment/PA7EYZ9Z8TE3Y" target="_blank">Haz tu aporte voluntario</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Sección principal del libro y promoción -->
    <main class="container mx-auto py-8 px-4 md:px-0">
        <div class="bg-white rounded-xl shadow-lg p-6 md:p-10 mb-8 md:flex md:items-center">
            <div class="md:w-1/2">
                <img src="https://imgur.com/J8zEWjP.jpg" alt="Portada del libro 'Pioneros de Coronel Pringles'" class="w-full h-auto rounded-lg shadow-2xl transform hover:scale-105 transition-transform duration-300">
            </div>
            <div class="md:w-1/2 md:pl-12 mt-6 md:mt-0">
                <h2 class="text-3xl md:text-4xl font-bold text-brown-custom">Una obra de Cristina A. Bottini</h2>
                <p class="mt-4 text-lg leading-relaxed">
                    El primero de los 7 libros que componen la obra "Pioneros de Coronel Pringles" (letras A y B).
                    En este libro se encuentran reunidos los apellidos que pertenecieron a quienes dejaron documentación que acreditó su paso o destino definitivo en el territorio del actual Partido de Coronel Pringles, entre 1870 hasta 1903.
                </p>
                <div class="mt-6 flex flex-col md:flex-row items-center md:justify-start space-y-4 md:space-y-0 md:space-x-8">
                    <div class="text-center">
                        <p class="text-4xl font-extrabold text-[#e45d17]">$37.000</p>
                        <p class="text-sm font-semibold text-gray-500">Precio del libro</p>
                        <!-- Nuevo letrero "autofinanciemos la cultura" con tamaño responsivo y color naranja -->
                        <p class="text-4xl md:text-5xl font-extrabold text-[#e45d17] mt-4">autofinanciemos la cultura</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sección de Edición para coleccionistas y código QR -->
        <div class="flex flex-col md:flex-row justify-between items-center bg-[#f4e2c8] rounded-xl shadow-lg p-6 md:p-10 mb-8">
            <div class="md:w-2/3 text-center md:text-left">
                <h3 class="text-2xl md:text-3xl font-bold text-brown-custom">Una Edición para Coleccionistas</h3>
                <p class="mt-2 md:mt-4 text-lg leading-relaxed">
                    Recordá que de toda esta obra solo se publicarán 3000 libros en castellano y no se difundirá en formato virtual.
                    <br>
                    <span class="font-bold text-[#e45d17]">Solo 3000 personas poseerán la historia de los Pioneros.</span>
                </p>
            </div>
            <div class="md:w-1/3 mt-6 md:mt-0 flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-8">
                <div class="text-center">
                    <a href="https://www.facebook.com/people/Investigaci%C3%B3n-Hist%C3%B3rica-Coronel-Pringles/100068762413207/?name=xhp_nt__fb__action__open_user" class="block hover:scale-110 transition-transform duration-300" target="_blank">
                        <img src="https://imgur.com/i97na4a.jpg" alt="Código QR Mercado Libre" class="w-32 h-32 rounded-lg border-2 border-gray-300 p-1">
                        <p class="mt-2 text-sm font-semibold">Facebook</p>
                    </a>
                </div>
                <div class="text-center">
                    <a href="https://articulo.mercadolibre.com.ar/MLA-1515266761-pioneros-de-coronel-pringles-1870-1903-i-_JM#polycard_client=search-nordic&position=36&search_layout=stack&type=item&tracking_id=2893e5d4-75db-49c8-8ecf-e9f2ec34ee24&wid=MLA1515266761&sid=search" target="_blank">
                        <img src="https://imgur.com/tRYqDpP.jpg" alt="Código QR Facebook" class="w-32 h-32 rounded-lg border-2 border-gray-300 p-1">
                        <p class="mt-2 text-sm font-semibold">Mercado libre</p>
                    </a>
                </div>
            </div>
        </div>

        <!-- Nueva Sección de Colaboración -->
        <section id="colaboracion" class="bg-[#fcf7e6] rounded-xl shadow-lg p-6 md:p-10 mb-8 text-center">
            <h3 class="text-2xl md:text-3xl font-bold text-brown-custom mb-4">"La muerte es el olvido"</h3>
            <p class="mt-2 text-lg leading-relaxed text-gray-700 max-w-2xl mx-auto">
                Es el lema de esta iniciativa que busca publicar la obra de 7 libros, "Pioneros de Coronel Pringles 1870-1903".
                Este trabajo hará que más de 15,500 de los primeros habitantes de la zona "revivan" al reunirlos con sus descendientes, preservando su memoria para las futuras generaciones. **Ayúdanos a revivir a los pioneros.**
                <br><br>
                Si no puedes comprar el libro o vives fuera del país y quieres ayudar con la publicación de la obra, cualquier aporte es bienvenido.
                <br>
                **¡Haz tu aporte voluntario para este proyecto!**
            </p>
            <a href="https://www.paypal.com/ncp/payment/PA7EYZ9Z8TE3Y" target="_blank" class="mt-6 inline-block bg-[#e45d17] text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:bg-[#cf5114] transition-colors duration-300 text-center">
                Haz tu aporte voluntario
            </a>
        </section>

        <!-- Sección de Compra Anticipada -->
        <section id="compra-anticipada" class="bg-white rounded-xl shadow-lg p-6 md:p-10 mt-8 mb-8 text-center">
            <h3 class="text-2xl md:text-3xl font-bold text-brown-custom mb-2">COMPRA ANTICIPADA</h3>
            <p class="text-lg leading-relaxed text-gray-700 mb-6">Solo para compras en Argentina</p>
            <div class="flex justify-center">
                <img id="anticipadaImg" src="https://imgur.com/2u3P8NU.jpg" alt="Flyer de compra anticipada del libro" class="w-full md:max-w-xl rounded-lg shadow-lg border-4 border-gray-300 cursor-pointer hover:scale-105 transition-transform duration-300">
            </div>
        </section>

        <!-- Sección de preguntas e intereses -->
        <section id="comentarios" class="bg-white rounded-xl shadow-lg p-6 md:p-10">
            <h3 class="text-2xl md:text-3xl font-bold text-brown-custom text-center">Preguntas, Intereses y Observaciones</h3>
            <p class="mt-2 text-center text-gray-600">¿Tienes alguna pregunta sobre la investigación, te interesa un apellido en particular o quieres compartir una observación? Este es tu espacio.</p>
            <!-- Formulario con el nuevo endpoint de Formspree para enviar a ambos correos. -->
            <form id="comment-form" action="https://formspree.io/f/xandnnvn" method="POST" class="mt-6 space-y-4">
                <!-- El campo `_replyto` le dice a Formspree a dónde responder. -->
                <input type="email" name="email" placeholder="Tu Correo (opcional)" class="w-full p-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#e45d17]">
                <!-- El campo `name` será el que se vea en el correo. -->
                <input type="text" name="name" placeholder="Tu Nombre (opcional)" class="w-full p-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#e45d17]">
                <!-- El campo `message` es el contenido del comentario. -->
                <textarea rows="5" name="message" placeholder="Tus comentarios..." class="w-full p-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#e45d17]"></textarea>
                <button type="submit" class="w-full bg-[#e45d17] text-white font-bold py-3 px-4 rounded-lg shadow-lg hover:bg-[#cf5114] transition-colors duration-300">
                    Enviar
                </button>
            </form>
        </section>
        
        <!-- Sección de imágenes de los códigos QR grandes y la carátula -->
        <div class="flex flex-col items-center mt-8 space-y-8">
            <div class="text-center">
                <!-- Imagen del código QR grande con evento de click y tamaño aumentado -->
                <img id="qrImg" src="https://imgur.com/1jjzucw.jpg" alt="Código QR Grande Mercado Libre" class="w-full md:max-w-2xl rounded-lg shadow-lg border-4 border-gray-300 cursor-pointer hover:scale-105 transition-transform duration-300">
                <p class="mt-4 text-xl font-bold"></p>
            </div>

            <!-- Texto insertado aquí -->
            <div class="text-center mt-8">
                <h3 class="text-2xl md:text-3xl font-bold text-brown-custom">PIONEROS DE CORONEL PRINGLES I<br>1870 - 1903<br>Primera entrega</h3>
                <p class="mt-4 text-lg leading-relaxed text-gray-700 max-w-2xl mx-auto">
                    La identidad es una construcción social. Todo individuo construye su identidad a partir de las bases familiares, su entorno más próximo y, finalmente, la sociedad en que está inmerso. Esta construcción no es simplemente la percepción que el individuo tiene de sí mientras está en proceso, sino lo que proyecta en los otros y la aceptación o no de aquello que pretende para sí, por ello lleva tiempo e involucra todo el aspecto sociocultural que rodea a este individuo.
                    <br><br>
                    Identidad es sinónimo de pertenencia. La cultura de los pueblos define en gran medida su identidad y su historia la reafirma. Conocer las raíces del sitio en que hemos nacido, a sus pioneros, cómo se emplazaban en sus comienzos sus viviendas, la disposición de sus edificios más importantes, su trabajo, su forma de vida y, sobre todo, sus orígenes y lo que hicieron por ese sitio, es fundamentar las bases de nuestra identidad, cimentarla, y reafirmar el sentido de pertenencia que toda identidad necesita para que el individuo considere poseer un lugar de origen no conceptual simplemente, sino emocional.
                </p>
            </div>

            <div class="text-center flex flex-col items-center">
                <!-- Imagen de la portada del libro grande con evento de click y tamaño aumentado -->
                <img id="myImg" src="https://imgur.com/vQ0DPKC.jpg" alt="Imagen de la portada del libro grande" class="w-full md:max-w-2xl rounded-lg shadow-lg border-4 border-gray-300 cursor-pointer hover:scale-105 transition-transform duration-300">
                <p class="mt-4 text-xl font-bold"></p>
                <!-- Botón de listado A-B -->
                <a href="https://drive.google.com/file/d/1gjxOYU4XM3SLWIbt_9uTZzrzjc8jyppS/view?usp=drivesdk" target="_blank" class="mt-6 w-full md:w-auto bg-[#e45d17] text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:bg-[#cf5114] transition-colors duration-300 text-center">
                    Descarga listado A-B 
                </a>
            </div>
        </div>
        
        <!-- Galería de imágenes - Sección nueva -->
        <section id="gallery-section" class="bg-white rounded-xl shadow-lg p-6 md:p-10 mt-8 mb-8 relative" style="display: none;">
            <h3 class="text-2xl md:text-3xl font-bold text-brown-custom text-center mb-6">Galería de Imágenes</h3>
            
            <!-- Nuevo botón para cerrar la galería en la esquina superior derecha -->
            <button id="close-gallery-btn" class="absolute top-4 right-4 bg-gray-500 text-white font-bold py-2 px-4 rounded-lg shadow-lg hover:bg-gray-600 transition-colors duration-300">
                Cerrar Galería
            </button>

            <div id="image-gallery" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
                <!-- Las imágenes se cargarán dinámicamente aquí -->
            </div>
        </section>
        
        <!-- Sección de Próximas Publicaciones -->
        <section id="proximas-publicaciones" class="bg-[#fcf7e6] rounded-xl shadow-lg p-6 md:p-10 mt-8 mb-8 text-center">
            <h2 class="text-3xl md:text-4xl font-bold text-brown-custom mb-6">Próximas publicaciones</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Tarjeta 1 -->
                <a href="#" class="block bg-white rounded-xl p-6 shadow-md hover:shadow-xl transition-shadow duration-300">
                    <h4 class="text-lg font-bold text-[#e45d17] mb-2">próximamente...</h4>
                    <p class="text-xl md:text-2xl font-semibold text-gray-800">LIBRO II: C-CH-D</p>
                </a>
                <!-- Tarjeta 2 -->
                <a href="#" class="block bg-white rounded-xl p-6 shadow-md hover:shadow-xl transition-shadow duration-300">
                    <h4 class="text-lg font-bold text-[#e45d17] mb-2">próximamente...</h4>
                    <p class="text-xl md:text-2xl font-semibold text-gray-800">LIBRO III: E-F-G</p>
                </a>
                <!-- Tarjeta 3 -->
                <a href="#" class="block bg-white rounded-xl p-6 shadow-md hover:shadow-xl transition-shadow duration-300">
                    <h4 class="text-lg font-bold text-[#e45d17] mb-2">próximamente...</h4>
                    <p class="text-xl md:text-2xl font-semibold text-gray-800">LIBRO IV: H-I-J-K-L-LL</p>
                </a>
                <!-- Tarjeta 4 -->
                <a href="#" class="block bg-white rounded-xl p-6 shadow-md hover:shadow-xl transition-shadow duration-300">
                    <h4 class="text-lg font-bold text-[#e45d17] mb-2">próximamente...</h4>
                    <p class="text-xl md:text-2xl font-semibold text-gray-800">LIBRO V: M-N-O</p>
                </a>
                <!-- Tarjeta 5 -->
                <a href="#" class="block bg-white rounded-xl p-6 shadow-md hover:shadow-xl transition-shadow duration-300">
                    <h4 class="text-lg font-bold text-[#e45d17] mb-2">próximamente...</h4>
                    <p class="text-xl md:text-2xl font-semibold text-gray-800">LIBRO VI: P-Q-R</p>
                </a>
                <!-- Tarjeta 6 -->
                <a href="#" class="block bg-white rounded-xl p-6 shadow-md hover:shadow-xl transition-shadow duration-300">
                    <h4 class="text-lg font-bold text-[#e45d17] mb-2">próximamente...</h4>
                    <p class="text-xl md:text-2xl font-semibold text-gray-800">LIBRO VII: S-T-U-V-W-X-Y-Z</p>
                </a>
            </div>
        </section>

    </main>

    <!-- Modal para la imagen expandida (con botones de carrusel) -->
    <div id="image-modal" class="modal">
        <span class="close">&times;</span>
        <img class="modal-content" id="imgExpanded">
        <a class="prev" id="prev-img-btn">&#10094;</a>
        <a class="next" id="next-img-btn">&#10095;</a>
    </div>

    <!-- Modal para mensajes de alerta y listas -->
    <div id="message-modal" class="modal">
        <div class="modal-content text-gray-800">
            <span class="close-btn absolute top-2 right-4 text-xl font-bold cursor-pointer">&times;</span>
            <div id="modal-content-text"></div>
        </div>
    </div>

    <!-- Pie de página -->
    <footer class="bg-gray-800 text-white p-4 md:p-8 text-center mt-8">
        <p>&copy; 2024 Pioneros de Coronel Pringles. Todos los derechos reservados.</p>
    </footer>

    <script type="module">
        // --- Lógica de la Interfaz de Usuario y Manejadores de Eventos ---

        // Función para mostrar un mensaje simple en el modal
        function showMessage(message) {
            const messageModal = document.getElementById("message-modal");
            const modalContentText = document.getElementById("modal-content-text");
            modalContentText.innerHTML = `<p class="p-4">${message}</p>`;
            messageModal.style.display = "flex";
        }

        // Modal para expandir imágenes
        const imageModal = document.getElementById("image-modal");
        const modalImg = document.getElementById("imgExpanded");
        const myImg = document.getElementById("myImg"); // Imagen de la portada del libro
        const qrImg = document.getElementById("qrImg"); // Imagen del QR
        const anticipadaImg = document.getElementById("anticipadaImg"); // La nueva imagen de compra anticipada
        const imageCloseBtn = document.querySelector("#image-modal .close");
        const prevImgBtn = document.getElementById('prev-img-btn');
        const nextImgBtn = document.getElementById('next-img-btn');

        let currentImageIndex = 0; // Para rastrear la imagen actual en la galería
        let activeGalleryImages = []; // Array de imágenes de la galería activa (puede ser solo la portada/qr o la galería completa)

        function openImageModal(imageSrc, sourceArray = [], initialIndex = 0) {
            imageModal.style.display = "flex";
            modalImg.src = imageSrc;
            activeGalleryImages = sourceArray;
            currentImageIndex = initialIndex;

            // Mostrar/ocultar botones de navegación si hay más de una imagen en la "galería activa"
            if (activeGalleryImages.length > 1) {
                prevImgBtn.style.display = 'block';
                nextImgBtn.style.display = 'block';
            } else {
                prevImgBtn.style.display = 'none';
                nextImgBtn.style.display = 'none';
            }
        }

        // Funciones para navegar en el carrusel
        function showNextImage() {
            if (activeGalleryImages.length === 0) return;
            currentImageIndex = (currentImageIndex + 1) % activeGalleryImages.length;
            modalImg.src = activeGalleryImages[currentImageIndex];
        }

        function showPrevImage() {
            if (activeGalleryImages.length === 0) return;
            currentImageIndex = (currentImageIndex - 1 + activeGalleryImages.length) % activeGalleryImages.length;
            modalImg.src = activeGalleryImages[currentImageIndex];
        }

        // Eventos para abrir el modal (ahora con soporte para carrusel)
        myImg.onclick = function() {
            // Abrir la imagen de la portada. No forma parte de la galería principal, así que no hay navegación aquí.
            openImageModal(this.src, [this.src], 0);
        };
        qrImg.onclick = function() {
            // Abrir la imagen del QR. No forma parte de la galería principal.
            openImageModal(this.src, [this.src], 0);
        };
        
        // Evento para la nueva imagen de "Compra Anticipada"
        anticipadaImg.onclick = function() {
            openImageModal(this.src, [this.src], 0);
        };

        // Eventos para los botones de navegación del carrusel
        prevImgBtn.onclick = showPrevImage;
        nextImgBtn.onclick = showNextImage;

        imageCloseBtn.onclick = function() { imageModal.style.display = "none"; };

        // Modal para mensajes
        const messageModal = document.getElementById("message-modal");
        const messageCloseBtn = document.querySelector("#message-modal .close-btn");

        messageCloseBtn.onclick = function() {
            messageModal.style.display = "none";
        };

        window.onclick = function(event) {
            if (event.target == imageModal) {
                imageModal.style.display = "none";
            }
            if (event.target == messageModal) {
                messageModal.style.display = "none";
            }
            // Cerrar el dropdown si se hace clic fuera de él
            const dropdown = document.querySelector('.dropdown');
            const dropdownContent = document.querySelector('.dropdown-content');
            const dropdownToggleButton = document.getElementById('dropdown-toggle-btn');

            if (!dropdown.contains(event.target)) {
                dropdownContent.classList.remove('show-dropdown');
                dropdownToggleButton.setAttribute('aria-expanded', 'false');
            }
        };

        // --- Lógica para el Menú Desplegable (Toggle on Click) ---
        const dropdownToggleButton = document.getElementById('dropdown-toggle-btn');
        const dropdownContent = document.querySelector('.dropdown-content');

        if (dropdownToggleButton && dropdownContent) {
            dropdownToggleButton.addEventListener('click', function(event) {
                const isExpanded = this.getAttribute('aria-expanded') === 'true' || false;
                dropdownContent.classList.toggle('show-dropdown');
                this.setAttribute('aria-expanded', !isExpanded);
                event.stopPropagation(); // Evita que el clic se propague al window y cierre el menú inmediatamente
            });
        }

        // --- Lógica para la Galería de Imágenes ---
        const imageGallery = document.getElementById('image-gallery');
        const gallerySection = document.getElementById('gallery-section');
        const dropdownGalleryBtn = document.getElementById('dropdown-gallery-btn'); // ID del enlace en el dropdown
        const closeGalleryBtn = document.getElementById('close-gallery-btn'); // Nuevo botón para cerrar la galería
        const galleryImages = [
            "https://imgur.com/TKJd2hO.jpg",
            "https://imgur.com/6985d9L.jpg",
            "https://imgur.com/X29XzPe.jpg",
            "https://imgur.com/szLDpaa.jpg",
            "https://imgur.com/DUtEz7e.jpg",
            "https://imgur.com/BRRVctA.jpg",
            "https://imgur.com/8cVzYvQ.jpg",
            "https://imgur.com/QEQOgU4.jpg",
            "https://imgur.com/88G7DE9.jpg",
            "https://imgur.com/7U88Ha9.jpg",
            "https://imgur.com/6BlguSc.jpg",
            "https://imgur.com/3MSCcyE.jpg",
            "https://imgur.com/9WFSfJ0.jpg",
            "https://imgur.com/DIHZkdm.jpg",
            "https://imgur.com/jcXBkhC.jpg",
            "https://imgur.com/mCUdmQ9.jpg",
            "https://imgur.com/jERM8FB.jpg",
            "https://imgur.com/lr3GYJv.jpg",
            "https://imgur.com/a5Cj8h2.jpg",
            "https://imgur.com/wZnNeGs.jpg",
            "https://imgur.com/tZCFOZD.jpg",
            "https://imgur.com/MaO67rT.jpg",
            "https://imgur.com/ctOe4wY.jpg",
            "https://imgur.com/dHvSSQe.jpg"
        ];

        // Cargar y mostrar las imágenes de la galería
        function loadGalleryImages() {
            imageGallery.innerHTML = ''; // Limpiar galería antes de cargar
            galleryImages.forEach((src, index) => {
                const img = document.createElement('img');
                img.src = src;
                img.alt = `Imagen ${index + 1} de la galería del libro`;
                img.className = "w-full h-auto rounded-lg shadow-md cursor-pointer hover:scale-105 transition-transform duration-300";
                // Al hacer clic en una imagen de la galería, se abre con funcionalidad de carrusel
                img.onclick = () => openImageModal(img.src, galleryImages, index);
                imageGallery.appendChild(img);
            });
        }
        
        // Función para cerrar la galería y subir al inicio
        function closeGalleryAndScrollToTop() {
            gallerySection.style.display = "none";
            window.scrollTo({ top: 0, behavior: 'smooth' }); // Desplazarse al inicio de la página
        }

        // Manejador para el enlace de "Galería" en el dropdown (toggle)
        if (dropdownGalleryBtn) { 
            dropdownGalleryBtn.addEventListener('click', function(e) {
                e.preventDefault(); 
                if (gallerySection.style.display === "none" || gallerySection.style.display === "") {
                    gallerySection.style.display = "block";
                    gallerySection.scrollIntoView({ behavior: 'smooth' });
                } else {
                    closeGalleryAndScrollToTop();
                }
                // Asegúrate de cerrar el dropdown después de seleccionar "Galería"
                dropdownContent.classList.remove('show-dropdown');
                dropdownToggleButton.setAttribute('aria-expanded', 'false');
            });
        }

        // Manejador para el nuevo botón "Cerrar Galería" dentro de la sección
        if (closeGalleryBtn) {
            closeGalleryBtn.addEventListener('click', function() {
                closeGalleryAndScrollToTop();
            });
        }

        // Llamar a la función para cargar las imágenes cuando la página esté lista
        window.addEventListener('load', loadGalleryImages);

        // --- Manejador para el formulario de comentarios ---
        const commentForm = document.getElementById('comment-form');
        commentForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            const form = e.target;
            const data = new FormData(form);
            const action = form.action;

            // Mostrar un mensaje de "Enviando..."
            showMessage("Enviando mensaje...");

            try {
                const response = await fetch(action, {
                    method: 'POST',
                    body: data,
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                if (response.ok) {
                    showMessage("¡Mensaje enviado con éxito!");
                    form.reset(); // Limpia los campos del formulario
                } else {
                    const errorData = await response.json();
                    if (Object.keys(errorData).length > 0) {
                        const errorMessage = Object.values(errorData).join(", ");
                        showMessage(`Error al enviar: ${errorMessage}`);
                    } else {
                        showMessage("Error al enviar el mensaje. Por favor, inténtalo de nuevo.");
                    }
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage("Error de conexión. Por favor, revisa tu conexión a internet.");
            }
        });
    </script>
</body>
</html>

